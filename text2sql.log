2025-07-14 23:57:07,758 - HTTP Request: GET http://localhost:8080/v1/meta "HTTP/1.1 200 OK"
2025-07-14 23:57:07,763 - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-07-14 23:57:11,818 - HTTP Request: GET http://localhost:8080/v1/schema/LlamaIndex_78a78a425a864624b9416bcf4b22b51e "HTTP/1.1 404 Not Found"
2025-07-14 23:57:12,036 - HTTP Request: POST http://localhost:8080/v1/schema "HTTP/1.1 200 OK"
2025-07-14 23:57:23,109 - ❌ Query processing error: 'patients'
2025-07-15 00:00:03,836 - HTTP Request: GET http://localhost:8080/v1/meta "HTTP/1.1 200 OK"
2025-07-15 00:00:03,844 - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-07-15 00:00:09,832 - HTTP Request: GET http://localhost:8080/v1/schema/LlamaIndex_0a7938360d8b4a31995bbc7608d8eaf4 "HTTP/1.1 404 Not Found"
2025-07-15 00:00:10,111 - HTTP Request: POST http://localhost:8080/v1/schema "HTTP/1.1 200 OK"
2025-07-15 00:00:29,890 - ❌ Query processing error: 'patients'
2025-07-15 00:00:36,652 - 🔍 Extracting entities from query: What are the most common procedures performed by cardiologists?
2025-07-15 00:00:36,653 - ✅ Found state: CA
2025-07-15 00:00:36,653 - ✅ Mapped states: 1 values, 0 columns
2025-07-15 00:00:36,653 - ✅ Entity extraction completed. Found 1 entity types
2025-07-15 00:00:36,653 - 🔄 Generating HyDE SQL examples...
2025-07-15 00:00:40,397 - ✅ Generated 3 HyDE SQL examples
2025-07-15 00:00:41,347 - ✅ Retrieved 5 context documents with HyDE enhancement
2025-07-15 00:00:41,347 - 🔍 Starting SQL generation for: What are the most common procedures performed by cardiologists?
2025-07-15 00:00:41,348 - 📋 Query classified as: Procedure Analysis
2025-07-15 00:00:41,348 - 🤖 Calling hybrid generator...
2025-07-15 00:00:41,348 - 🔍 Processing: What are the most common procedures performed by cardiologists?
2025-07-15 00:00:41,348 - 🔍 Processing query: What are the most common procedures performed by cardiologists?
2025-07-15 00:00:41,348 - 🔥 Generating SQL with Gemini 2.5 Flash (FREE)...
2025-07-15 00:00:43,792 - ✅ Gemini SQL generation successful
2025-07-15 00:00:43,793 - 🔥 Gemini generation successful! (2.445s)
2025-07-15 00:00:43,793 - 🔍 Validating SQL against ClickHouse...
2025-07-15 00:00:43,793 - 🔍 ClickHouse attempt 1: {'host': 'localhost', 'port': 8123, 'username': 'default', 'password': 'mysecret'}
2025-07-15 00:00:43,935 - ❌ Attempt 1 failed: HTTPDriver for http://localhost:8123 received ClickHouse error code 62
 Code: 62. DB::Exception: Syntax error: failed at position 57 (() (line 1, col 57): ( SELECT ap.type_1_npi, ap.first_name, ap.last_name, ap.specialties, ap.states, 'Cardiac Catheterization' AS procedure_name  -- Replace with actual procedure na... Unmatched parentheses: (. (SYNTAX_ERROR) (version 25.6.3.116 (official build))

2025-07-15 00:00:43,936 - ⚠️ ClickHouse unavailable, using syntax-only validation
2025-07-15 00:00:43,937 - 📊 Calculating confidence score...
2025-07-15 00:00:43,937 - ✅ SQL generated via gemini_generated with confidence 80.0%
2025-07-15 00:01:02,176 - 🔍 Extracting entities from query: Top 5 drugs prescribed by endocrinologists in Florida
2025-07-15 00:01:02,176 - ✅ Found state: FL
2025-07-15 00:01:02,176 - ✅ Found state: Florida
2025-07-15 00:01:02,176 - ✅ Mapped states: 2 values, 0 columns
2025-07-15 00:01:02,177 - ✅ Mapped numbers: 1 values, 0 columns
2025-07-15 00:01:02,177 - ✅ Entity extraction completed. Found 2 entity types
2025-07-15 00:01:02,177 - 🔄 Generating HyDE SQL examples...
2025-07-15 00:01:04,449 - ✅ Generated 3 HyDE SQL examples
2025-07-15 00:01:04,954 - ✅ Retrieved 5 context documents with HyDE enhancement
2025-07-15 00:01:04,955 - 🔍 Starting SQL generation for: Top 5 drugs prescribed by endocrinologists in Florida
2025-07-15 00:01:04,955 - 📋 Query classified as: Prescription Analysis
2025-07-15 00:01:04,955 - 🤖 Calling hybrid generator...
2025-07-15 00:01:04,955 - 🔍 Processing: Top 5 drugs prescribed by endocrinologists in Florida
2025-07-15 00:01:04,955 - 🔍 Processing query: Top 5 drugs prescribed by endocrinologists in Florida
2025-07-15 00:01:04,955 - 🔥 Generating SQL with Gemini 2.5 Flash (FREE)...
2025-07-15 00:01:06,707 - ✅ Gemini SQL generation successful
2025-07-15 00:01:06,708 - 🔥 Gemini generation successful! (1.753s)
2025-07-15 00:01:06,708 - 🔍 Validating SQL against ClickHouse...
2025-07-15 00:01:06,708 - 🔍 ClickHouse attempt 1: {'host': 'localhost', 'port': 8123, 'username': 'default', 'password': 'mysecret'}
2025-07-15 00:01:06,755 - ❌ Attempt 1 failed: HTTPDriver for http://localhost:8123 received ClickHouse error code 60
 Code: 60. DB::Exception: Unknown table expression identifier 'fct_pharmacy_clear_claim_allstatus_cluster_brand' in scope SELECT f.NDC_PREFERRED_BRAND_NM AS drug_name, COUNT(*) AS prescription_count FROM fct_pharmacy_clear_claim_allstatus_cluster_brand AS f INNER JOIN as_providers_v1 AS p ON f.PRESCRIBER_NPI_NBR = CAST(p.type_1_npi, 'String') WHERE ((p.specialties[1]) ILIKE '%Endocrinology%') AND ((p.states[1]) = 'FL') GROUP BY drug_name ORDER BY prescription_count DESC LIMIT 5. (UNKNOWN_TABLE) (version 25.6.3.116 (official build))

2025-07-15 00:01:06,757 - ⚠️ ClickHouse unavailable, using syntax-only validation
2025-07-15 00:01:06,757 - 📊 Calculating confidence score...
2025-07-15 00:01:06,757 - ✅ SQL generated via gemini_generated with confidence 80.0%
2025-07-15 00:01:22,225 - 🔍 Extracting entities from query: Comprehensive procedure center analysis for hernia repair: volume, outcomes, provider expertise, and financial performance in FL
2025-07-15 00:01:22,225 - ✅ Found state: FL
2025-07-15 00:01:22,225 - ✅ Found state: PA
2025-07-15 00:01:22,226 - ✅ Found state: NC
2025-07-15 00:01:22,226 - ✅ Found procedure: hernia repair
2025-07-15 00:01:22,226 - ✅ Mapped states: 3 values, 0 columns
2025-07-15 00:01:22,226 - ✅ Mapped procedures: 1 values, 0 columns
2025-07-15 00:01:22,226 - ✅ Entity extraction completed. Found 2 entity types
2025-07-15 00:01:22,226 - 🔄 Generating HyDE SQL examples...
2025-07-15 00:01:26,166 - ✅ Generated 3 HyDE SQL examples
2025-07-15 00:01:27,056 - ✅ Retrieved 5 context documents with HyDE enhancement
2025-07-15 00:01:27,056 - 🔍 Starting SQL generation for: Comprehensive procedure center analysis for hernia repair: volume, outcomes, provider expertise, and financial performance in FL
2025-07-15 00:01:27,057 - 📋 Query classified as: Procedure Analysis
2025-07-15 00:01:27,057 - 🤖 Calling hybrid generator...
2025-07-15 00:01:27,057 - 🔍 Processing: Comprehensive procedure center analysis for hernia repair: volume, outcomes, provider expertise, and financial performance in FL
2025-07-15 00:01:27,057 - 🔍 Processing query: Comprehensive procedure center analysis for hernia repair: volume, outcomes, provider expertise, and financial performance in FL
2025-07-15 00:01:27,057 - 🔥 Generating SQL with Gemini 2.5 Flash (FREE)...
2025-07-15 00:01:30,633 - ✅ Gemini SQL generation successful
2025-07-15 00:01:30,635 - 🔥 Gemini generation successful! (3.578s)
2025-07-15 00:01:30,635 - 🔍 Validating SQL against ClickHouse...
2025-07-15 00:01:30,635 - 🔍 ClickHouse attempt 1: {'host': 'localhost', 'port': 8123, 'username': 'default', 'password': 'mysecret'}
2025-07-15 00:01:30,695 - 📊 Calculating confidence score...
2025-07-15 00:01:30,696 - ✅ SQL generated via gemini_generated with confidence 50.0%
2025-07-15 00:49:32,077 - HTTP Request: GET http://localhost:8080/v1/meta "HTTP/1.1 200 OK"
2025-07-15 00:49:32,124 - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-07-15 00:49:38,070 - HTTP Request: GET http://localhost:8080/v1/schema/LlamaIndex_b8dd3bddb4be4988b95f4f7c0a1de693 "HTTP/1.1 404 Not Found"
2025-07-15 00:49:38,317 - HTTP Request: POST http://localhost:8080/v1/schema "HTTP/1.1 200 OK"
2025-07-15 00:52:28,578 - HTTP Request: GET http://localhost:8080/v1/meta "HTTP/1.1 200 OK"
2025-07-15 00:52:28,665 - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-07-15 00:52:40,679 - HTTP Request: GET http://localhost:8080/v1/schema/LlamaIndex_fa52c2e6b313456a896556359920a2d2 "HTTP/1.1 404 Not Found"
2025-07-15 00:52:40,908 - HTTP Request: POST http://localhost:8080/v1/schema "HTTP/1.1 200 OK"
